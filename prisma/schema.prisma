

generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}



enum Role {
  USER
  ADMIN
}

enum Status {
  ACTIVE      
  INACTIVE    
  BANNED      
  PENDING
  DELETED 
}


enum TravelType {
  ADVENTURE
  BUSINESS
  FAMILY
  SOLO
  FRIENDS
  HONEYMOON
  COUPLE
}


enum SubscriptionType {
  MONTHLY
  YEARLY
  WEEKLY
}

enum PaymentStatus {
  PAID
  UNPAID
}


model Payment {
  id              String        @id @default(uuid())
  userId          String
  user            User          @relation(fields: [userId], references: [id])
  amount          Float
  paymentGetWayData Json?
  subscriptionId  String
  subscription    Subscription  @relation(fields: [subscriptionId], references: [id])
  status          PaymentStatus @default(UNPAID)
  provider        String?
  paymentIntentId String?
  createdAt       DateTime      @default(now())
  updatedAt       DateTime      @updatedAt

  @@map("payments")
}


model Review {
  id           String      @id @default(uuid())
  rating       Int         @default(5)
  comment      String
  reviewer     User       @relation(fields: [reviewerId], references: [id])
  reviewerId   String
  travelPlan   TravelPlan  @relation(fields: [travelPlanId], references: [id])
  travelPlanId String
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  @@map("reviews")
}


model Subscription {
  id        String   @id @default(uuid())
  type      SubscriptionType
  startDate DateTime @default(now())
  endDate   DateTime
  payment   Payment[]
  user      User     @relation("SubscriptionToUser", fields: [userId], references: [id])
  userId    String   @unique
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("subscriptions")
}

model TravelPlan {
  id           String      @id @default(uuid())
  title        String
  destination  String
  startDate    DateTime
  endDate      DateTime
  budget       Float
  travelType   TravelType
  description  String?
  visibility   Boolean     @default(true)
  hostId       String
  host         User        @relation(fields: [hostId], references: [id])
  participants User[]      @relation("PlanParticipants")
  reviews      Review[]
  createdAt    DateTime    @default(now())
  updatedAt    DateTime    @updatedAt

  @@map("travelPlans")
}


model User {
  id               String        @id @default(uuid())
  fullName         String
  email            String        @unique
  password         String
  profileImage     String?         
  bio              String?
  travelInterests  String[]        
  visitedCountries String[]       
  currentLocation  String?
  contactNumber    String?
  userStatus       Status        @default(ACTIVE)
  role             Role          @default(USER)
  verified         Boolean       @default(false)
  subscription     Subscription? @relation("SubscriptionToUser") 
  travelPlans      TravelPlan[]   
  subscriptionActive   Boolean    @default(false) 
  subscriptionExpiresAt   DateTime?
  joinedPlans      TravelPlan[]   @relation("PlanParticipants")
  reviews          Review[]        
  createdAt        DateTime      @default(now())
  updatedAt        DateTime      @updatedAt
  payments Payment[]

  @@map("users")
}
